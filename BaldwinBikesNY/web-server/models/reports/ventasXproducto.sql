SELECT catg.descripcion as Categoria, prod.nomProducto as NombreProducto, sum(detord.precioVenta) as Total FROM produccion.productos prod JOIN produccion.categorias catg ON prod.idCategoria = catg.idCategoria JOIN ventas.detalleOrden detord ON prod.idProducto = detord.idProducto JOIN ventas.ordenes ord ON detord.idOrden = ord.idOrden WHERE ord.idTienda = ? AND prod.idCategoria = ? AND ord.fechaOrden >= ? AND ord.fechaOrden < ? GROUP BY prod.idCategoria, prod.idProducto;, , [tienda_id, category_id, fecha_inicial, fecha_final]